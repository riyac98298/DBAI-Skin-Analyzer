{% extends "base.html" %}
{% block content %}

<section class="rounded-2xl border bg-white p-6 shadow-sm space-y-5">
  <h2 class="text-lg font-semibold">Analysis Results</h2>

  <div class="grid gap-6 md:grid-cols-2">
    <!-- Annotated image -->
    <div>
      <img src="{{ url_for('static', filename='uploads/' + analyzed_filename) }}"
           alt="Analyzed" class="w-full rounded-xl ring-1 ring-gray-200" />
    </div>

    <!-- Scores & issues -->
    <div class="space-y-5">
      <div>
        <h3 class="mb-2 text-sm font-semibold text-gray-700">Detected issues</h3>
        <ul class="space-y-2 text-sm">
          {% if prob_dark_circles is not none %}
          <li class="flex items-center gap-3">
            <span class="inline-flex items-center rounded-full bg-indigo-50 px-2 py-0.5 text-indigo-700">Dark circles</span>
            <div class="h-2 w-40 rounded bg-gray-200">
              <div class="h-2 rounded bg-indigo-500" style="width: {{ (prob_dark_circles*100)|round(0) }}%"></div>
            </div>
            <span class="w-12 text-right">{{ (prob_dark_circles*100)|round(1) }}%</span>
          </li>
          {% endif %}
          {% if prob_acne is not none %}
          <li class="flex items-center gap-3">
            <span class="inline-flex items-center rounded-full bg-rose-50 px-2 py-0.5 text-rose-700">Acne</span>
            <div class="h-2 w-40 rounded bg-gray-200">
              <div class="h-2 rounded bg-rose-500" style="width: {{ (prob_acne*100)|round(0) }}%"></div>
            </div>
            <span class="w-12 text-right">{{ (prob_acne*100)|round(1) }}%</span>
          </li>
          {% endif %}
        </ul>
      </div>

      <!-- Recommendations with icons -->
      <div>
        <h3 class="mb-2 text-sm font-semibold text-gray-700">Recommended products</h3>
        <div class="space-y-3">
          {% for card in recommendations %}
          <div class="flex gap-3 rounded-xl border p-4">
            <!-- Tiny icon decided by keyword in title -->
            {% set t = card.title|lower %}
            {% if 'vitamin c' in t %}
              <svg class="mt-1 h-6 w-6 text-amber-500" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a7 7 0 017 7c0 4.97-7 13-7 13S5 13.97 5 9a7 7 0 017-7zm0 9.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"/></svg>
            {% elif 'salicylic' in t or 'bha' in t %}
              <svg class="mt-1 h-6 w-6 text-emerald-500" viewBox="0 0 24 24" fill="currentColor"><path d="M4 12a8 8 0 1116 0 8 8 0 01-16 0zm5-1h6v2H9z"/></svg>
            {% elif 'sunscreen' in t or 'spf' in t %}
              <svg class="mt-1 h-6 w-6 text-yellow-500" viewBox="0 0 24 24" fill="currentColor"><path d="M12 18a6 6 0 100-12 6 6 0 000 12zm1-16V0h-2v2h2zm0 22v-2h-2v2h2zm9-11h-2v2h2v-2zM4 13H2v-2h2v2zm14.95 6.536l-1.414-1.414-1.414 1.414 1.414 1.414 1.414-1.414zM7.05 4.95L5.636 3.536 4.222 4.95l1.414 1.414L7.05 4.95z"/></svg>
            {% else %}
              <svg class="mt-1 h-6 w-6 text-brand" viewBox="0 0 24 24" fill="currentColor"><path d="M7 4h10l1 4H6l1-4zm-1 6h12l-1 10H7L6 10z"/></svg>
            {% endif %}
            <div>
              <div class="font-medium">{{ card.title }}</div>
              <p class="mt-1 text-sm text-gray-600">{{ card.note }}</p>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>

      <div>
        <a href="{{ url_for('index') }}"
           class="inline-flex items-center rounded-xl bg-brand px-4 py-2 font-medium text-white hover:bg-brand-dark">
          Analyze another photo
        </a>
      </div>
    </div>
  </div>
</section>

{% endblock %}
